{"version":3,"sources":["../src/actions/registerIP.ts","../src/functions/uploadJSONToIPFS.ts","../src/providers/wallet.ts","../src/templates/index.ts","../src/actions/licenseIP.ts","../src/queries.ts","../src/actions/attachTerms.ts","../src/actions/getAvailableLicenses.ts","../src/lib/api.ts","../src/actions/getIPDetails.ts","../src/index.ts"],"sourcesContent":["import {\n    composeContext,\n    elizaLogger,\n    generateObjectDeprecated,\n    HandlerCallback,\n    ModelClass,\n    IAgentRuntime,\n    Memory,\n    State,\n} from \"@elizaos/core\";\nimport pinataSDK from \"@pinata/sdk\";\nimport { RegisterIpResponse } from \"@story-protocol/core-sdk\";\nimport { createHash } from \"crypto\";\nimport { uploadJSONToIPFS } from \"../functions/uploadJSONToIPFS\";\nimport { WalletProvider } from \"../providers/wallet\";\nimport { registerIPTemplate } from \"../templates\";\nimport { RegisterIPParams } from \"../types\";\n\nexport { registerIPTemplate };\n\nexport class RegisterIPAction {\n    constructor(private walletProvider: WalletProvider) {}\n\n    async registerIP(\n        params: RegisterIPParams,\n        runtime: IAgentRuntime\n    ): Promise<RegisterIpResponse> {\n        const storyClient = this.walletProvider.getStoryClient();\n\n        // configure ip metadata\n        const ipMetadata = storyClient.ipAsset.generateIpMetadata({\n            title: params.title,\n            description: params.description,\n            ipType: params.ipType ? params.ipType : undefined,\n        });\n\n        // configure nft metadata\n        const nftMetadata = {\n            name: params.title,\n            description: params.description,\n        };\n\n        const pinataJWT = runtime.getSetting(\"PINATA_JWT\");\n        if (!pinataJWT) throw new Error(\"PINATA_JWT not configured\");\n        const pinata = new pinataSDK({ pinataJWTKey: pinataJWT });\n\n        // upload metadata to ipfs\n        const ipIpfsHash = await uploadJSONToIPFS(pinata, ipMetadata);\n        const ipHash = createHash(\"sha256\")\n            .update(JSON.stringify(ipMetadata))\n            .digest(\"hex\");\n        const nftIpfsHash = await uploadJSONToIPFS(pinata, nftMetadata);\n        const nftHash = createHash(\"sha256\")\n            .update(JSON.stringify(nftMetadata))\n            .digest(\"hex\");\n\n        // register ip\n        const response =\n            await storyClient.ipAsset.mintAndRegisterIpAssetWithPilTerms({\n                spgNftContract: \"0xC81B2cbEFD1aA0227bf513729580d3CF40fd61dF\",\n                terms: [],\n                ipMetadata: {\n                    ipMetadataURI: `https://ipfs.io/ipfs/${ipIpfsHash}`,\n                    ipMetadataHash: `0x${ipHash}`,\n                    nftMetadataURI: `https://ipfs.io/ipfs/${nftIpfsHash}`,\n                    nftMetadataHash: `0x${nftHash}`,\n                },\n                txOptions: { waitForTransaction: true },\n            });\n\n        return response;\n    }\n}\n\nexport const registerIPAction = {\n    name: \"REGISTER_IP\",\n    description: \"Register an NFT as an IP Asset on Story\",\n    handler: async (\n        runtime: IAgentRuntime,\n        message: Memory,\n        state: State,\n        options: any,\n        callback?: HandlerCallback\n    ): Promise<boolean> => {\n        elizaLogger.log(\"Starting REGISTER_IP handler...\");\n\n        // initialize or update state\n        if (!state) {\n            state = (await runtime.composeState(message)) as State;\n        } else {\n            state = await runtime.updateRecentMessageState(state);\n        }\n\n        const registerIPContext = composeContext({\n            state,\n            template: registerIPTemplate,\n        });\n\n        const content = await generateObjectDeprecated({\n            runtime,\n            context: registerIPContext,\n            modelClass: ModelClass.SMALL,\n        });\n\n        const walletProvider = new WalletProvider(runtime);\n        const action = new RegisterIPAction(walletProvider);\n        try {\n            const response = await action.registerIP(content, runtime);\n            callback?.({\n                text: `Successfully registered IP ID: ${response.ipId}. Transaction Hash: ${response.txHash}. View it on the explorer: https://explorer.story.foundation/ipa/${response.ipId}`,\n            });\n            return true;\n        } catch (e) {\n            elizaLogger.error(\"Error registering IP:\", e.message);\n            callback?.({ text: `Error registering IP: ${e.message}` });\n            return false;\n        }\n    },\n    template: registerIPTemplate,\n    validate: async (runtime: IAgentRuntime) => {\n        const privateKey = runtime.getSetting(\"STORY_PRIVATE_KEY\");\n        return typeof privateKey === \"string\" && privateKey.startsWith(\"0x\");\n    },\n    examples: [\n        [\n            {\n                user: \"{{user1}}\",\n                content: {\n                    text: \"I would like to register my IP.\",\n                },\n            },\n            {\n                user: \"{{user2}}\",\n                content: {\n                    text: \"Sure! Please provide the title and description of your IP.\",\n                    action: \"REGISTER_IP\",\n                },\n            },\n            {\n                user: \"{{user1}}\",\n                content: {\n                    text: \"Register my IP titled 'My IP' with the description 'This is my IP'\",\n                },\n            },\n        ],\n    ],\n    similes: [\"REGISTER_IP\", \"REGISTER_NFT\"],\n};\n","import PinataClient from \"@pinata/sdk\";\n\nexport async function uploadJSONToIPFS(\n    pinata: PinataClient,\n    jsonMetadata: any\n): Promise<string> {\n    const { IpfsHash } = await pinata.pinJSONToIPFS(jsonMetadata);\n    return IpfsHash;\n}\n","import { IAgentRuntime, Provider, Memory, State } from \"@elizaos/core\";\nimport {\n    createPublicClient,\n    createWalletClient,\n    http,\n    formatUnits,\n    type PublicClient,\n    type WalletClient,\n    type Chain,\n    type HttpTransport,\n    type Address,\n    Account,\n} from \"viem\";\nimport { storyOdyssey } from \"viem/chains\";\nimport type { SupportedChain, ChainMetadata } from \"../types\";\nimport { privateKeyToAccount } from \"viem/accounts\";\nimport { StoryClient, StoryConfig } from \"@story-protocol/core-sdk\";\n\nexport const DEFAULT_CHAIN_CONFIGS: Record<SupportedChain, ChainMetadata> = {\n    odyssey: {\n        chainId: 1516,\n        name: \"Odyssey Testnet\",\n        chain: storyOdyssey,\n        rpcUrl: \"https://odyssey.storyrpc.io/\",\n        nativeCurrency: {\n            name: \"IP\",\n            symbol: \"IP\",\n            decimals: 18,\n        },\n        blockExplorerUrl: \"https://odyssey.storyscan.xyz\",\n    },\n} as const;\n\nexport class WalletProvider {\n    private storyClient: StoryClient;\n    private publicClient: PublicClient<\n        HttpTransport,\n        Chain,\n        Account | undefined\n    >;\n    private walletClient: WalletClient;\n    private address: Address;\n    runtime: IAgentRuntime;\n\n    constructor(runtime: IAgentRuntime) {\n        const privateKey = runtime.getSetting(\"STORY_PRIVATE_KEY\");\n        if (!privateKey) throw new Error(\"STORY_PRIVATE_KEY not configured\");\n\n        this.runtime = runtime;\n\n        const account = privateKeyToAccount(privateKey as Address);\n        this.address = account.address;\n\n        const config: StoryConfig = {\n            account: account,\n            transport: http(DEFAULT_CHAIN_CONFIGS.odyssey.rpcUrl),\n            chainId: \"odyssey\",\n        };\n        this.storyClient = StoryClient.newClient(config);\n\n        const baseConfig = {\n            chain: storyOdyssey,\n            transport: http(DEFAULT_CHAIN_CONFIGS.odyssey.rpcUrl),\n        } as const;\n        this.publicClient = createPublicClient<HttpTransport>(\n            baseConfig\n        ) as PublicClient<HttpTransport, Chain, Account | undefined>;\n\n        this.walletClient = createWalletClient<HttpTransport>({\n            chain: storyOdyssey,\n            transport: http(DEFAULT_CHAIN_CONFIGS.odyssey.rpcUrl),\n            account: account,\n        });\n    }\n\n    getAddress(): Address {\n        return this.address;\n    }\n\n    async getWalletBalance(): Promise<string | null> {\n        try {\n            const balance = await this.publicClient.getBalance({\n                address: this.address,\n            });\n            return formatUnits(balance, 18);\n        } catch (error) {\n            console.error(\"Error getting wallet balance:\", error);\n            return null;\n        }\n    }\n\n    async connect(): Promise<`0x${string}`> {\n        return this.runtime.getSetting(\"STORY_PRIVATE_KEY\") as `0x${string}`;\n    }\n\n    getPublicClient(): PublicClient<HttpTransport, Chain, Account | undefined> {\n        return this.publicClient;\n    }\n\n    getWalletClient(): WalletClient {\n        if (!this.walletClient) throw new Error(\"Wallet not connected\");\n        return this.walletClient;\n    }\n\n    getStoryClient(): StoryClient {\n        if (!this.storyClient) throw new Error(\"StoryClient not connected\");\n        return this.storyClient;\n    }\n}\n\nexport const storyWalletProvider: Provider = {\n    async get(\n        runtime: IAgentRuntime,\n        message: Memory,\n        state?: State\n    ): Promise<string | null> {\n        // Check if the user has a Story wallet\n        if (!runtime.getSetting(\"STORY_PRIVATE_KEY\")) {\n            return null;\n        }\n\n        try {\n            const walletProvider = new WalletProvider(runtime);\n            const address = walletProvider.getAddress();\n            const balance = await walletProvider.getWalletBalance();\n            return `Story Wallet Address: ${address}\\nBalance: ${balance} IP`;\n        } catch (error) {\n            console.error(\"Error in Story wallet provider:\", error);\n            return null;\n        }\n    },\n};\n","export const registerIPTemplate = `Given the recent messages below:\n\n{{recentMessages}}\n\nExtract the following information about the requested IP registration:\n- Field \"title\": The title of your IP\n- Field \"description\": The description of your IP\n- Field \"ipType\": The type of your IP. Type of the IP Asset, can be defined arbitrarily by the\ncreator. I.e. “character”, “chapter”, “location”, “items”, \"music\", etc. If a user doesn't provide\nan ipType, you can infer it from the title and description. It should be one word.\n\nRespond with a JSON markdown block containing only the extracted values. A user must explicitly provide a title and description.\n\n\\`\\`\\`json\n{\n    \"title\": string,\n    \"description\": string,\n    \"ipType\": string\n}\n\\`\\`\\`\n`;\n\nexport const licenseIPTemplate = `Given the recent messages below:\n\n{{recentMessages}}\n\nExtract the following information about the requested IP licensing:\n- Field \"licensorIpId\": The IP Asset that you want to mint a license from\n- Field \"licenseTermsId\": The license terms that you want to mint a license for\n- Field \"amount\": The amount of licenses to mint\n\nRespond with a JSON markdown block containing only the extracted values. A user must explicitly provide a licensorIpId and licenseTermsId.\nIf they don't provide the amount, set it as null.\n\n\\`\\`\\`json\n{\n    \"licensorIpId\": string,\n    \"licenseTermsId\": string,\n    \"amount\": number | null\n}\n\\`\\`\\`\n`;\n\nexport const getAvailableLicensesTemplate = `Given the recent messages and wallet information below:\n\n{{recentMessages}}\n\n{{walletInfo}}\n\nExtract the following information about the requested IP licensing:\n- Field \"ipid\": The IP Asset that you want to mint a license from\n\nRespond with a JSON markdown block containing only the extracted values. A user must provide an ipId.\n\n\\`\\`\\`json\n{\n    \"ipid\": string\n}\n\\`\\`\\`\n`;\n\nexport const getIPDetailsTemplate = `Given the recent messages below:\n\n{{recentMessages}}\n\nExtract the following information about the requested IP details:\n- Field \"ipId\": The IP Asset that you want to get details for\n\nRespond with a JSON markdown block containing only the extracted values. A user must provide an ipId.\n\n\\`\\`\\`json\n{\n    \"ipId\": string\n}\n\\`\\`\\`\n`;\n\nexport const attachTermsTemplate = `Given the recent messages below:\n\n{{recentMessages}}\n\nExtract the following information about attaching license terms to an IP Asset:\n- Field \"ipId\": The IP Asset that you want to attach the license terms to\n- Field \"mintingFee\": The fee to mint this license from the IP Asset.\n- Field \"commercialUse\": Whether or not the IP Asset can be used commercially.\n- Field \"commercialRevShare\": The percentage of revenue that the IP Asset owner will receive\nfrom commercial use of the IP Asset. This must be between 0 and 100. If a user specifies\na commercialRevShare, then commercialUse must be set to true.\n\nRespond with a JSON markdown block containing only the extracted values. A user must provide an ipId. If they don't provide\nthe others fields, set them as null.\n\n\\`\\`\\`json\n{\n    \"ipId\": string,\n    \"mintingFee\": number | null,\n    \"commercialUse\": boolean | null,\n    \"commercialRevShare\": number | null\n}\n\\`\\`\\`\n`;\n","import {\n    composeContext,\n    elizaLogger,\n    generateObjectDeprecated,\n    HandlerCallback,\n    ModelClass,\n    IAgentRuntime,\n    Memory,\n    State,\n} from \"@elizaos/core\";\nimport { WalletProvider } from \"../providers/wallet\";\nimport { licenseIPTemplate } from \"../templates\";\nimport { LicenseIPParams } from \"../types\";\nimport { MintLicenseTokensResponse } from \"@story-protocol/core-sdk\";\nimport { hasIpAttachedLicenseTerms } from \"../queries\";\n\nexport { licenseIPTemplate };\n\nexport class LicenseIPAction {\n    constructor(private walletProvider: WalletProvider) {}\n\n    async licenseIP(\n        params: LicenseIPParams\n    ): Promise<MintLicenseTokensResponse> {\n        const storyClient = this.walletProvider.getStoryClient();\n        const publicClient = this.walletProvider.getPublicClient();\n\n        const hasLicenseTerms = await hasIpAttachedLicenseTerms(publicClient, {\n            ipId: params.licensorIpId,\n            licenseTemplate: \"0x58E2c909D557Cd23EF90D14f8fd21667A5Ae7a93\",\n            licenseTermsId: BigInt(params.licenseTermsId),\n        });\n        // check if license terms are attached to the ip asset\n        if (!hasLicenseTerms) {\n            throw new Error(\"License terms are not attached to the IP Asset\");\n        }\n        const response = await storyClient.license.mintLicenseTokens({\n            licensorIpId: params.licensorIpId,\n            licenseTermsId: params.licenseTermsId,\n            amount: params.amount || 1,\n            txOptions: { waitForTransaction: true },\n        });\n\n        return response;\n    }\n}\n\nexport const licenseIPAction = {\n    name: \"LICENSE_IP\",\n    description: \"License an IP Asset on Story\",\n    handler: async (\n        runtime: IAgentRuntime,\n        message: Memory,\n        state: State,\n        options: any,\n        callback?: HandlerCallback\n    ): Promise<boolean> => {\n        elizaLogger.log(\"Starting LICENSE_IP handler...\");\n\n        // initialize or update state\n        if (!state) {\n            state = (await runtime.composeState(message)) as State;\n        } else {\n            state = await runtime.updateRecentMessageState(state);\n        }\n\n        const licenseIPContext = composeContext({\n            state,\n            template: licenseIPTemplate,\n        });\n\n        const content = await generateObjectDeprecated({\n            runtime,\n            context: licenseIPContext,\n            modelClass: ModelClass.SMALL,\n        });\n\n        const walletProvider = new WalletProvider(runtime);\n        const action = new LicenseIPAction(walletProvider);\n        try {\n            const response = await action.licenseIP(content);\n            callback?.({\n                text: `Successfully minted license tokens: ${response.licenseTokenIds.join(\", \")}. Transaction Hash: ${response.txHash}. View it on the block explorer: https://odyssey.storyscan.xyz/tx/${response.txHash}`,\n            });\n            return true;\n        } catch (e) {\n            elizaLogger.error(\"Error licensing IP:\", e.message);\n            callback?.({ text: `Error licensing IP: ${e.message}` });\n            return false;\n        }\n    },\n    template: licenseIPTemplate,\n    validate: async (runtime: IAgentRuntime) => {\n        const privateKey = runtime.getSetting(\"STORY_PRIVATE_KEY\");\n        return typeof privateKey === \"string\" && privateKey.startsWith(\"0x\");\n    },\n    examples: [\n        [\n            {\n                user: \"{{user1}}\",\n                content: {\n                    text: \"I would like to license an IP.\",\n                },\n            },\n            {\n                user: \"{{user2}}\",\n                content: {\n                    text: \"Sure! Please provide the ipId of the IP you want to license and the license terms id you want to attach.\",\n                    action: \"LICENSE_IP\",\n                },\n            },\n            {\n                user: \"{{user1}}\",\n                content: {\n                    text: \"License an IP Asset 0x2265F2b8e47F98b3Bdf7a1937EAc27282954A4Db with license terms 1\",\n                },\n            },\n        ],\n    ],\n    similes: [\"LICENSE\", \"LICENSE_IP\", \"LICENSE_IP_ASSET\"],\n};\n","import { Account, HttpTransport, Chain, Address, PublicClient } from \"viem\";\n\ntype LicenseRegistryHasIpAttachedLicenseTermsRequest = {\n    ipId: Address;\n    licenseTemplate: Address;\n    licenseTermsId: bigint;\n};\n\nexport const licenseRegistryAbi = [\n    {\n        type: \"constructor\",\n        inputs: [\n            {\n                name: \"licensingModule\",\n                internalType: \"address\",\n                type: \"address\",\n            },\n            { name: \"disputeModule\", internalType: \"address\", type: \"address\" },\n            { name: \"ipGraphAcl\", internalType: \"address\", type: \"address\" },\n        ],\n        stateMutability: \"nonpayable\",\n    },\n    {\n        type: \"error\",\n        inputs: [\n            { name: \"authority\", internalType: \"address\", type: \"address\" },\n        ],\n        name: \"AccessManagedInvalidAuthority\",\n    },\n    {\n        type: \"error\",\n        inputs: [\n            { name: \"caller\", internalType: \"address\", type: \"address\" },\n            { name: \"delay\", internalType: \"uint32\", type: \"uint32\" },\n        ],\n        name: \"AccessManagedRequiredDelay\",\n    },\n    {\n        type: \"error\",\n        inputs: [{ name: \"caller\", internalType: \"address\", type: \"address\" }],\n        name: \"AccessManagedUnauthorized\",\n    },\n    {\n        type: \"error\",\n        inputs: [{ name: \"target\", internalType: \"address\", type: \"address\" }],\n        name: \"AddressEmptyCode\",\n    },\n    {\n        type: \"error\",\n        inputs: [\n            {\n                name: \"implementation\",\n                internalType: \"address\",\n                type: \"address\",\n            },\n        ],\n        name: \"ERC1967InvalidImplementation\",\n    },\n    { type: \"error\", inputs: [], name: \"ERC1967NonPayable\" },\n    { type: \"error\", inputs: [], name: \"FailedInnerCall\" },\n    { type: \"error\", inputs: [], name: \"InvalidInitialization\" },\n    {\n        type: \"error\",\n        inputs: [\n            { name: \"childIpId\", internalType: \"address\", type: \"address\" },\n            {\n                name: \"parentIpIds\",\n                internalType: \"address[]\",\n                type: \"address[]\",\n            },\n        ],\n        name: \"LicenseRegistry__AddParentIpToIPGraphFailed\",\n    },\n    {\n        type: \"error\",\n        inputs: [],\n        name: \"LicenseRegistry__CallerNotLicensingModule\",\n    },\n    {\n        type: \"error\",\n        inputs: [\n            { name: \"childIpId\", internalType: \"address\", type: \"address\" },\n        ],\n        name: \"LicenseRegistry__DerivativeAlreadyRegistered\",\n    },\n    {\n        type: \"error\",\n        inputs: [\n            { name: \"childIpId\", internalType: \"address\", type: \"address\" },\n        ],\n        name: \"LicenseRegistry__DerivativeIpAlreadyHasChild\",\n    },\n    {\n        type: \"error\",\n        inputs: [\n            { name: \"childIpId\", internalType: \"address\", type: \"address\" },\n        ],\n        name: \"LicenseRegistry__DerivativeIpAlreadyHasLicense\",\n    },\n    {\n        type: \"error\",\n        inputs: [{ name: \"ipId\", internalType: \"address\", type: \"address\" }],\n        name: \"LicenseRegistry__DerivativeIsParent\",\n    },\n    {\n        type: \"error\",\n        inputs: [\n            { name: \"ipId\", internalType: \"address\", type: \"address\" },\n            {\n                name: \"licenseTemplate\",\n                internalType: \"address\",\n                type: \"address\",\n            },\n            {\n                name: \"licenseTermsId\",\n                internalType: \"uint256\",\n                type: \"uint256\",\n            },\n        ],\n        name: \"LicenseRegistry__DuplicateLicense\",\n    },\n    {\n        type: \"error\",\n        inputs: [\n            { name: \"ipId\", internalType: \"address\", type: \"address\" },\n            { name: \"index\", internalType: \"uint256\", type: \"uint256\" },\n            { name: \"length\", internalType: \"uint256\", type: \"uint256\" },\n        ],\n        name: \"LicenseRegistry__IndexOutOfBounds\",\n    },\n    {\n        type: \"error\",\n        inputs: [{ name: \"ipId\", internalType: \"address\", type: \"address\" }],\n        name: \"LicenseRegistry__IpExpired\",\n    },\n    {\n        type: \"error\",\n        inputs: [\n            { name: \"ipId\", internalType: \"address\", type: \"address\" },\n            {\n                name: \"licenseTemplate\",\n                internalType: \"address\",\n                type: \"address\",\n            },\n            {\n                name: \"licenseTermsId\",\n                internalType: \"uint256\",\n                type: \"uint256\",\n            },\n        ],\n        name: \"LicenseRegistry__LicenseTermsAlreadyAttached\",\n    },\n    {\n        type: \"error\",\n        inputs: [\n            {\n                name: \"licenseTemplate\",\n                internalType: \"address\",\n                type: \"address\",\n            },\n            {\n                name: \"licenseTermsId\",\n                internalType: \"uint256\",\n                type: \"uint256\",\n            },\n        ],\n        name: \"LicenseRegistry__LicenseTermsNotExists\",\n    },\n    {\n        type: \"error\",\n        inputs: [\n            { name: \"ipId\", internalType: \"address\", type: \"address\" },\n            {\n                name: \"licenseTemplate\",\n                internalType: \"address\",\n                type: \"address\",\n            },\n            {\n                name: \"licenseTermsId\",\n                internalType: \"uint256\",\n                type: \"uint256\",\n            },\n        ],\n        name: \"LicenseRegistry__LicensorIpHasNoLicenseTerms\",\n    },\n    {\n        type: \"error\",\n        inputs: [\n            {\n                name: \"licenseTemplate\",\n                internalType: \"address\",\n                type: \"address\",\n            },\n        ],\n        name: \"LicenseRegistry__NotLicenseTemplate\",\n    },\n    {\n        type: \"error\",\n        inputs: [{ name: \"ipId\", internalType: \"address\", type: \"address\" }],\n        name: \"LicenseRegistry__ParentIpExpired\",\n    },\n    {\n        type: \"error\",\n        inputs: [\n            { name: \"ipId\", internalType: \"address\", type: \"address\" },\n            {\n                name: \"licenseTermsId\",\n                internalType: \"uint256\",\n                type: \"uint256\",\n            },\n        ],\n        name: \"LicenseRegistry__ParentIpHasNoLicenseTerms\",\n    },\n    {\n        type: \"error\",\n        inputs: [{ name: \"ipId\", internalType: \"address\", type: \"address\" }],\n        name: \"LicenseRegistry__ParentIpTagged\",\n    },\n    {\n        type: \"error\",\n        inputs: [\n            { name: \"ipId\", internalType: \"address\", type: \"address\" },\n            {\n                name: \"licenseTemplate\",\n                internalType: \"address\",\n                type: \"address\",\n            },\n        ],\n        name: \"LicenseRegistry__ParentIpUnmatchedLicenseTemplate\",\n    },\n    {\n        type: \"error\",\n        inputs: [\n            { name: \"ipId\", internalType: \"address\", type: \"address\" },\n            {\n                name: \"licenseTemplate\",\n                internalType: \"address\",\n                type: \"address\",\n            },\n            {\n                name: \"newLicenseTemplate\",\n                internalType: \"address\",\n                type: \"address\",\n            },\n        ],\n        name: \"LicenseRegistry__UnmatchedLicenseTemplate\",\n    },\n    {\n        type: \"error\",\n        inputs: [\n            {\n                name: \"licenseTemplate\",\n                internalType: \"address\",\n                type: \"address\",\n            },\n        ],\n        name: \"LicenseRegistry__UnregisteredLicenseTemplate\",\n    },\n    { type: \"error\", inputs: [], name: \"LicenseRegistry__ZeroAccessManager\" },\n    { type: \"error\", inputs: [], name: \"LicenseRegistry__ZeroDisputeModule\" },\n    { type: \"error\", inputs: [], name: \"LicenseRegistry__ZeroIPGraphACL\" },\n    { type: \"error\", inputs: [], name: \"LicenseRegistry__ZeroLicenseTemplate\" },\n    { type: \"error\", inputs: [], name: \"LicenseRegistry__ZeroLicensingModule\" },\n    {\n        type: \"error\",\n        inputs: [],\n        name: \"LicensingModule__DerivativesCannotAddLicenseTerms\",\n    },\n    {\n        type: \"error\",\n        inputs: [\n            {\n                name: \"licenseTemplate\",\n                internalType: \"address\",\n                type: \"address\",\n            },\n            {\n                name: \"licenseTermsId\",\n                internalType: \"uint256\",\n                type: \"uint256\",\n            },\n        ],\n        name: \"LicensingModule__LicenseTermsNotFound\",\n    },\n    { type: \"error\", inputs: [], name: \"NotInitializing\" },\n    { type: \"error\", inputs: [], name: \"UUPSUnauthorizedCallContext\" },\n    {\n        type: \"error\",\n        inputs: [{ name: \"slot\", internalType: \"bytes32\", type: \"bytes32\" }],\n        name: \"UUPSUnsupportedProxiableUUID\",\n    },\n    {\n        type: \"event\",\n        anonymous: false,\n        inputs: [\n            {\n                name: \"authority\",\n                internalType: \"address\",\n                type: \"address\",\n                indexed: false,\n            },\n        ],\n        name: \"AuthorityUpdated\",\n    },\n    {\n        type: \"event\",\n        anonymous: false,\n        inputs: [\n            {\n                name: \"licenseTemplate\",\n                internalType: \"address\",\n                type: \"address\",\n                indexed: false,\n            },\n            {\n                name: \"licenseTermsId\",\n                internalType: \"uint256\",\n                type: \"uint256\",\n                indexed: false,\n            },\n        ],\n        name: \"DefaultLicenseTermsSet\",\n    },\n    {\n        type: \"event\",\n        anonymous: false,\n        inputs: [\n            {\n                name: \"ipId\",\n                internalType: \"address\",\n                type: \"address\",\n                indexed: true,\n            },\n            {\n                name: \"expireTime\",\n                internalType: \"uint256\",\n                type: \"uint256\",\n                indexed: false,\n            },\n        ],\n        name: \"ExpirationTimeSet\",\n    },\n    {\n        type: \"event\",\n        anonymous: false,\n        inputs: [\n            {\n                name: \"version\",\n                internalType: \"uint64\",\n                type: \"uint64\",\n                indexed: false,\n            },\n        ],\n        name: \"Initialized\",\n    },\n    {\n        type: \"event\",\n        anonymous: false,\n        inputs: [\n            {\n                name: \"licenseTemplate\",\n                internalType: \"address\",\n                type: \"address\",\n                indexed: true,\n            },\n        ],\n        name: \"LicenseTemplateRegistered\",\n    },\n    {\n        type: \"event\",\n        anonymous: false,\n        inputs: [\n            {\n                name: \"ipId\",\n                internalType: \"address\",\n                type: \"address\",\n                indexed: true,\n            },\n            {\n                name: \"licensingConfig\",\n                internalType: \"struct Licensing.LicensingConfig\",\n                type: \"tuple\",\n                components: [\n                    { name: \"isSet\", internalType: \"bool\", type: \"bool\" },\n                    {\n                        name: \"mintingFee\",\n                        internalType: \"uint256\",\n                        type: \"uint256\",\n                    },\n                    {\n                        name: \"licensingHook\",\n                        internalType: \"address\",\n                        type: \"address\",\n                    },\n                    { name: \"hookData\", internalType: \"bytes\", type: \"bytes\" },\n                ],\n                indexed: false,\n            },\n        ],\n        name: \"LicensingConfigSetForIP\",\n    },\n    {\n        type: \"event\",\n        anonymous: false,\n        inputs: [\n            {\n                name: \"ipId\",\n                internalType: \"address\",\n                type: \"address\",\n                indexed: true,\n            },\n            {\n                name: \"licenseTemplate\",\n                internalType: \"address\",\n                type: \"address\",\n                indexed: true,\n            },\n            {\n                name: \"licenseTermsId\",\n                internalType: \"uint256\",\n                type: \"uint256\",\n                indexed: true,\n            },\n        ],\n        name: \"LicensingConfigSetForLicense\",\n    },\n    {\n        type: \"event\",\n        anonymous: false,\n        inputs: [\n            {\n                name: \"implementation\",\n                internalType: \"address\",\n                type: \"address\",\n                indexed: true,\n            },\n        ],\n        name: \"Upgraded\",\n    },\n    {\n        type: \"function\",\n        inputs: [],\n        name: \"DISPUTE_MODULE\",\n        outputs: [\n            {\n                name: \"\",\n                internalType: \"contract IDisputeModule\",\n                type: \"address\",\n            },\n        ],\n        stateMutability: \"view\",\n    },\n    {\n        type: \"function\",\n        inputs: [],\n        name: \"EXPIRATION_TIME\",\n        outputs: [{ name: \"\", internalType: \"bytes32\", type: \"bytes32\" }],\n        stateMutability: \"view\",\n    },\n    {\n        type: \"function\",\n        inputs: [],\n        name: \"IP_GRAPH\",\n        outputs: [{ name: \"\", internalType: \"address\", type: \"address\" }],\n        stateMutability: \"view\",\n    },\n    {\n        type: \"function\",\n        inputs: [],\n        name: \"IP_GRAPH_ACL\",\n        outputs: [\n            { name: \"\", internalType: \"contract IPGraphACL\", type: \"address\" },\n        ],\n        stateMutability: \"view\",\n    },\n    {\n        type: \"function\",\n        inputs: [],\n        name: \"LICENSING_MODULE\",\n        outputs: [\n            {\n                name: \"\",\n                internalType: \"contract ILicensingModule\",\n                type: \"address\",\n            },\n        ],\n        stateMutability: \"view\",\n    },\n    {\n        type: \"function\",\n        inputs: [],\n        name: \"UPGRADE_INTERFACE_VERSION\",\n        outputs: [{ name: \"\", internalType: \"string\", type: \"string\" }],\n        stateMutability: \"view\",\n    },\n    {\n        type: \"function\",\n        inputs: [\n            { name: \"ipId\", internalType: \"address\", type: \"address\" },\n            {\n                name: \"licenseTemplate\",\n                internalType: \"address\",\n                type: \"address\",\n            },\n            {\n                name: \"licenseTermsId\",\n                internalType: \"uint256\",\n                type: \"uint256\",\n            },\n        ],\n        name: \"attachLicenseTermsToIp\",\n        outputs: [],\n        stateMutability: \"nonpayable\",\n    },\n    {\n        type: \"function\",\n        inputs: [],\n        name: \"authority\",\n        outputs: [{ name: \"\", internalType: \"address\", type: \"address\" }],\n        stateMutability: \"view\",\n    },\n    {\n        type: \"function\",\n        inputs: [\n            {\n                name: \"licenseTemplate\",\n                internalType: \"address\",\n                type: \"address\",\n            },\n            {\n                name: \"licenseTermsId\",\n                internalType: \"uint256\",\n                type: \"uint256\",\n            },\n        ],\n        name: \"exists\",\n        outputs: [{ name: \"\", internalType: \"bool\", type: \"bool\" }],\n        stateMutability: \"view\",\n    },\n    {\n        type: \"function\",\n        inputs: [\n            { name: \"ipId\", internalType: \"address\", type: \"address\" },\n            { name: \"index\", internalType: \"uint256\", type: \"uint256\" },\n        ],\n        name: \"getAttachedLicenseTerms\",\n        outputs: [\n            {\n                name: \"licenseTemplate\",\n                internalType: \"address\",\n                type: \"address\",\n            },\n            {\n                name: \"licenseTermsId\",\n                internalType: \"uint256\",\n                type: \"uint256\",\n            },\n        ],\n        stateMutability: \"view\",\n    },\n    {\n        type: \"function\",\n        inputs: [{ name: \"ipId\", internalType: \"address\", type: \"address\" }],\n        name: \"getAttachedLicenseTermsCount\",\n        outputs: [{ name: \"\", internalType: \"uint256\", type: \"uint256\" }],\n        stateMutability: \"view\",\n    },\n    {\n        type: \"function\",\n        inputs: [],\n        name: \"getDefaultLicenseTerms\",\n        outputs: [\n            {\n                name: \"licenseTemplate\",\n                internalType: \"address\",\n                type: \"address\",\n            },\n            {\n                name: \"licenseTermsId\",\n                internalType: \"uint256\",\n                type: \"uint256\",\n            },\n        ],\n        stateMutability: \"view\",\n    },\n    {\n        type: \"function\",\n        inputs: [\n            { name: \"parentIpId\", internalType: \"address\", type: \"address\" },\n            { name: \"index\", internalType: \"uint256\", type: \"uint256\" },\n        ],\n        name: \"getDerivativeIp\",\n        outputs: [\n            { name: \"childIpId\", internalType: \"address\", type: \"address\" },\n        ],\n        stateMutability: \"view\",\n    },\n    {\n        type: \"function\",\n        inputs: [\n            { name: \"parentIpId\", internalType: \"address\", type: \"address\" },\n        ],\n        name: \"getDerivativeIpCount\",\n        outputs: [{ name: \"\", internalType: \"uint256\", type: \"uint256\" }],\n        stateMutability: \"view\",\n    },\n    {\n        type: \"function\",\n        inputs: [{ name: \"ipId\", internalType: \"address\", type: \"address\" }],\n        name: \"getExpireTime\",\n        outputs: [{ name: \"\", internalType: \"uint256\", type: \"uint256\" }],\n        stateMutability: \"view\",\n    },\n    {\n        type: \"function\",\n        inputs: [\n            { name: \"ipId\", internalType: \"address\", type: \"address\" },\n            {\n                name: \"licenseTemplate\",\n                internalType: \"address\",\n                type: \"address\",\n            },\n            {\n                name: \"licenseTermsId\",\n                internalType: \"uint256\",\n                type: \"uint256\",\n            },\n        ],\n        name: \"getLicensingConfig\",\n        outputs: [\n            {\n                name: \"\",\n                internalType: \"struct Licensing.LicensingConfig\",\n                type: \"tuple\",\n                components: [\n                    { name: \"isSet\", internalType: \"bool\", type: \"bool\" },\n                    {\n                        name: \"mintingFee\",\n                        internalType: \"uint256\",\n                        type: \"uint256\",\n                    },\n                    {\n                        name: \"licensingHook\",\n                        internalType: \"address\",\n                        type: \"address\",\n                    },\n                    { name: \"hookData\", internalType: \"bytes\", type: \"bytes\" },\n                ],\n            },\n        ],\n        stateMutability: \"view\",\n    },\n    {\n        type: \"function\",\n        inputs: [\n            { name: \"childIpId\", internalType: \"address\", type: \"address\" },\n            { name: \"index\", internalType: \"uint256\", type: \"uint256\" },\n        ],\n        name: \"getParentIp\",\n        outputs: [\n            { name: \"parentIpId\", internalType: \"address\", type: \"address\" },\n        ],\n        stateMutability: \"view\",\n    },\n    {\n        type: \"function\",\n        inputs: [\n            { name: \"childIpId\", internalType: \"address\", type: \"address\" },\n        ],\n        name: \"getParentIpCount\",\n        outputs: [{ name: \"\", internalType: \"uint256\", type: \"uint256\" }],\n        stateMutability: \"view\",\n    },\n    {\n        type: \"function\",\n        inputs: [\n            { name: \"childIpId\", internalType: \"address\", type: \"address\" },\n            { name: \"parentIpId\", internalType: \"address\", type: \"address\" },\n        ],\n        name: \"getParentLicenseTerms\",\n        outputs: [\n            {\n                name: \"licenseTemplate\",\n                internalType: \"address\",\n                type: \"address\",\n            },\n            {\n                name: \"licenseTermsId\",\n                internalType: \"uint256\",\n                type: \"uint256\",\n            },\n        ],\n        stateMutability: \"view\",\n    },\n    {\n        type: \"function\",\n        inputs: [\n            { name: \"parentIpId\", internalType: \"address\", type: \"address\" },\n        ],\n        name: \"hasDerivativeIps\",\n        outputs: [{ name: \"\", internalType: \"bool\", type: \"bool\" }],\n        stateMutability: \"view\",\n    },\n    {\n        type: \"function\",\n        inputs: [\n            { name: \"ipId\", internalType: \"address\", type: \"address\" },\n            {\n                name: \"licenseTemplate\",\n                internalType: \"address\",\n                type: \"address\",\n            },\n            {\n                name: \"licenseTermsId\",\n                internalType: \"uint256\",\n                type: \"uint256\",\n            },\n        ],\n        name: \"hasIpAttachedLicenseTerms\",\n        outputs: [{ name: \"\", internalType: \"bool\", type: \"bool\" }],\n        stateMutability: \"view\",\n    },\n    {\n        type: \"function\",\n        inputs: [\n            { name: \"accessManager\", internalType: \"address\", type: \"address\" },\n        ],\n        name: \"initialize\",\n        outputs: [],\n        stateMutability: \"nonpayable\",\n    },\n    {\n        type: \"function\",\n        inputs: [],\n        name: \"isConsumingScheduledOp\",\n        outputs: [{ name: \"\", internalType: \"bytes4\", type: \"bytes4\" }],\n        stateMutability: \"view\",\n    },\n    {\n        type: \"function\",\n        inputs: [\n            { name: \"childIpId\", internalType: \"address\", type: \"address\" },\n        ],\n        name: \"isDerivativeIp\",\n        outputs: [{ name: \"\", internalType: \"bool\", type: \"bool\" }],\n        stateMutability: \"view\",\n    },\n    {\n        type: \"function\",\n        inputs: [{ name: \"ipId\", internalType: \"address\", type: \"address\" }],\n        name: \"isExpiredNow\",\n        outputs: [{ name: \"\", internalType: \"bool\", type: \"bool\" }],\n        stateMutability: \"view\",\n    },\n    {\n        type: \"function\",\n        inputs: [\n            { name: \"parentIpId\", internalType: \"address\", type: \"address\" },\n            { name: \"childIpId\", internalType: \"address\", type: \"address\" },\n        ],\n        name: \"isParentIp\",\n        outputs: [{ name: \"\", internalType: \"bool\", type: \"bool\" }],\n        stateMutability: \"view\",\n    },\n    {\n        type: \"function\",\n        inputs: [\n            {\n                name: \"licenseTemplate\",\n                internalType: \"address\",\n                type: \"address\",\n            },\n        ],\n        name: \"isRegisteredLicenseTemplate\",\n        outputs: [{ name: \"\", internalType: \"bool\", type: \"bool\" }],\n        stateMutability: \"view\",\n    },\n    {\n        type: \"function\",\n        inputs: [],\n        name: \"proxiableUUID\",\n        outputs: [{ name: \"\", internalType: \"bytes32\", type: \"bytes32\" }],\n        stateMutability: \"view\",\n    },\n    {\n        type: \"function\",\n        inputs: [\n            { name: \"childIpId\", internalType: \"address\", type: \"address\" },\n            {\n                name: \"parentIpIds\",\n                internalType: \"address[]\",\n                type: \"address[]\",\n            },\n            {\n                name: \"licenseTemplate\",\n                internalType: \"address\",\n                type: \"address\",\n            },\n            {\n                name: \"licenseTermsIds\",\n                internalType: \"uint256[]\",\n                type: \"uint256[]\",\n            },\n            { name: \"isUsingLicenseToken\", internalType: \"bool\", type: \"bool\" },\n        ],\n        name: \"registerDerivativeIp\",\n        outputs: [],\n        stateMutability: \"nonpayable\",\n    },\n    {\n        type: \"function\",\n        inputs: [\n            {\n                name: \"licenseTemplate\",\n                internalType: \"address\",\n                type: \"address\",\n            },\n        ],\n        name: \"registerLicenseTemplate\",\n        outputs: [],\n        stateMutability: \"nonpayable\",\n    },\n    {\n        type: \"function\",\n        inputs: [\n            { name: \"newAuthority\", internalType: \"address\", type: \"address\" },\n        ],\n        name: \"setAuthority\",\n        outputs: [],\n        stateMutability: \"nonpayable\",\n    },\n    {\n        type: \"function\",\n        inputs: [\n            {\n                name: \"newLicenseTemplate\",\n                internalType: \"address\",\n                type: \"address\",\n            },\n            {\n                name: \"newLicenseTermsId\",\n                internalType: \"uint256\",\n                type: \"uint256\",\n            },\n        ],\n        name: \"setDefaultLicenseTerms\",\n        outputs: [],\n        stateMutability: \"nonpayable\",\n    },\n    {\n        type: \"function\",\n        inputs: [\n            { name: \"ipId\", internalType: \"address\", type: \"address\" },\n            {\n                name: \"licensingConfig\",\n                internalType: \"struct Licensing.LicensingConfig\",\n                type: \"tuple\",\n                components: [\n                    { name: \"isSet\", internalType: \"bool\", type: \"bool\" },\n                    {\n                        name: \"mintingFee\",\n                        internalType: \"uint256\",\n                        type: \"uint256\",\n                    },\n                    {\n                        name: \"licensingHook\",\n                        internalType: \"address\",\n                        type: \"address\",\n                    },\n                    { name: \"hookData\", internalType: \"bytes\", type: \"bytes\" },\n                ],\n            },\n        ],\n        name: \"setLicensingConfigForIp\",\n        outputs: [],\n        stateMutability: \"nonpayable\",\n    },\n    {\n        type: \"function\",\n        inputs: [\n            { name: \"ipId\", internalType: \"address\", type: \"address\" },\n            {\n                name: \"licenseTemplate\",\n                internalType: \"address\",\n                type: \"address\",\n            },\n            {\n                name: \"licenseTermsId\",\n                internalType: \"uint256\",\n                type: \"uint256\",\n            },\n            {\n                name: \"licensingConfig\",\n                internalType: \"struct Licensing.LicensingConfig\",\n                type: \"tuple\",\n                components: [\n                    { name: \"isSet\", internalType: \"bool\", type: \"bool\" },\n                    {\n                        name: \"mintingFee\",\n                        internalType: \"uint256\",\n                        type: \"uint256\",\n                    },\n                    {\n                        name: \"licensingHook\",\n                        internalType: \"address\",\n                        type: \"address\",\n                    },\n                    { name: \"hookData\", internalType: \"bytes\", type: \"bytes\" },\n                ],\n            },\n        ],\n        name: \"setLicensingConfigForLicense\",\n        outputs: [],\n        stateMutability: \"nonpayable\",\n    },\n    {\n        type: \"function\",\n        inputs: [\n            {\n                name: \"newImplementation\",\n                internalType: \"address\",\n                type: \"address\",\n            },\n            { name: \"data\", internalType: \"bytes\", type: \"bytes\" },\n        ],\n        name: \"upgradeToAndCall\",\n        outputs: [],\n        stateMutability: \"payable\",\n    },\n    {\n        type: \"function\",\n        inputs: [\n            { name: \"licensorIpId\", internalType: \"address\", type: \"address\" },\n            {\n                name: \"licenseTemplate\",\n                internalType: \"address\",\n                type: \"address\",\n            },\n            {\n                name: \"licenseTermsId\",\n                internalType: \"uint256\",\n                type: \"uint256\",\n            },\n            { name: \"isMintedByIpOwner\", internalType: \"bool\", type: \"bool\" },\n        ],\n        name: \"verifyMintLicenseToken\",\n        outputs: [\n            {\n                name: \"\",\n                internalType: \"struct Licensing.LicensingConfig\",\n                type: \"tuple\",\n                components: [\n                    { name: \"isSet\", internalType: \"bool\", type: \"bool\" },\n                    {\n                        name: \"mintingFee\",\n                        internalType: \"uint256\",\n                        type: \"uint256\",\n                    },\n                    {\n                        name: \"licensingHook\",\n                        internalType: \"address\",\n                        type: \"address\",\n                    },\n                    { name: \"hookData\", internalType: \"bytes\", type: \"bytes\" },\n                ],\n            },\n        ],\n        stateMutability: \"view\",\n    },\n] as const;\n\nexport async function hasIpAttachedLicenseTerms(\n    publicClient: PublicClient<HttpTransport, Chain, Account | undefined>,\n    request: LicenseRegistryHasIpAttachedLicenseTermsRequest\n): Promise<boolean> {\n    return await publicClient.readContract({\n        abi: licenseRegistryAbi,\n        address: \"0xBda3992c49E98392e75E78d82B934F3598bA495f\",\n        functionName: \"hasIpAttachedLicenseTerms\",\n        args: [request.ipId, request.licenseTemplate, request.licenseTermsId],\n    });\n}\n","import {\n    composeContext,\n    elizaLogger,\n    generateObjectDeprecated,\n    HandlerCallback,\n    ModelClass,\n    IAgentRuntime,\n    Memory,\n    State,\n} from \"@elizaos/core\";\nimport { WalletProvider } from \"../providers/wallet\";\nimport { attachTermsTemplate } from \"../templates\";\nimport {\n    AttachLicenseTermsResponse,\n    LicenseTerms,\n    RegisterPILResponse,\n} from \"@story-protocol/core-sdk\";\nimport { AttachTermsParams } from \"../types\";\nimport { zeroAddress } from \"viem\";\n\nexport { attachTermsTemplate };\n\nexport class AttachTermsAction {\n    constructor(private walletProvider: WalletProvider) {}\n\n    async attachTerms(params: AttachTermsParams): Promise<{\n        attachTermsResponse: AttachLicenseTermsResponse;\n        registerPilTermsResponse: RegisterPILResponse;\n    }> {\n        const storyClient = this.walletProvider.getStoryClient();\n\n        console.log(\"params\", params);\n\n        const licenseTerms: LicenseTerms = {\n            transferable: true,\n            royaltyPolicy: params.commercialUse\n                ? \"0x28b4F70ffE5ba7A26aEF979226f77Eb57fb9Fdb6\"\n                : zeroAddress,\n            defaultMintingFee: params.mintingFee\n                ? BigInt(params.mintingFee)\n                : BigInt(0),\n            expiration: BigInt(0),\n            commercialUse: params.commercialUse || false,\n            commercialAttribution: false,\n            commercializerChecker: zeroAddress,\n            commercializerCheckerData: zeroAddress,\n            commercialRevShare: params.commercialUse\n                ? params.commercialRevShare\n                : 0,\n            commercialRevCeiling: BigInt(0),\n            derivativesAllowed: true,\n            derivativesAttribution: true,\n            derivativesApproval: false,\n            derivativesReciprocal: true,\n            derivativeRevCeiling: BigInt(0),\n            currency: \"0xC0F6E387aC0B324Ec18EAcf22EE7271207dCE3d5\",\n            uri: \"\",\n        };\n\n        const registerPilTermsResponse =\n            await storyClient.license.registerPILTerms({\n                ...licenseTerms,\n                txOptions: { waitForTransaction: true },\n            });\n\n        const attachTermsResponse =\n            await storyClient.license.attachLicenseTerms({\n                ipId: params.ipId,\n                licenseTermsId: registerPilTermsResponse.licenseTermsId,\n                txOptions: { waitForTransaction: true },\n            });\n\n        return { attachTermsResponse, registerPilTermsResponse };\n    }\n}\n\nexport const attachTermsAction = {\n    name: \"ATTACH_TERMS\",\n    description: \"Attach license terms to an IP Asset on Story\",\n    handler: async (\n        runtime: IAgentRuntime,\n        message: Memory,\n        state: State,\n        options: any,\n        callback?: HandlerCallback\n    ): Promise<boolean> => {\n        elizaLogger.log(\"Starting ATTACH_TERMS handler...\");\n\n        // initialize or update state\n        if (!state) {\n            state = (await runtime.composeState(message)) as State;\n        } else {\n            state = await runtime.updateRecentMessageState(state);\n        }\n\n        const attachTermsContext = composeContext({\n            state,\n            template: attachTermsTemplate,\n        });\n\n        const content = await generateObjectDeprecated({\n            runtime,\n            context: attachTermsContext,\n            modelClass: ModelClass.SMALL,\n        });\n\n        const walletProvider = new WalletProvider(runtime);\n        const action = new AttachTermsAction(walletProvider);\n        try {\n            const response = await action.attachTerms(content);\n            // if license terms were attached\n            if (response.attachTermsResponse.success) {\n                callback?.({\n                    text: `Successfully attached license terms: ${response.registerPilTermsResponse.licenseTermsId}. Transaction Hash: ${response.attachTermsResponse.txHash}. View it on the block explorer: https://odyssey.storyscan.xyz/tx/${response.attachTermsResponse.txHash}`,\n                });\n                return true;\n            }\n            // if license terms were already attached\n            callback?.({\n                text: `License terms ${response.registerPilTermsResponse.licenseTermsId} were already attached to IP Asset ${content.ipId}`,\n            });\n            return true;\n        } catch (e) {\n            elizaLogger.error(\"Error licensing IP:\", e.message);\n            callback?.({ text: `Error licensing IP: ${e.message}` });\n            return false;\n        }\n    },\n    template: attachTermsTemplate,\n    validate: async (runtime: IAgentRuntime) => {\n        const privateKey = runtime.getSetting(\"STORY_PRIVATE_KEY\");\n        return typeof privateKey === \"string\" && privateKey.startsWith(\"0x\");\n    },\n    examples: [\n        [\n            {\n                user: \"{{user1}}\",\n                content: {\n                    text: \"I would like to attach license terms to my IP.\",\n                    action: \"ATTACH_TERMS\",\n                },\n            },\n            {\n                user: \"{{user2}}\",\n                content: {\n                    text: \"Sure! What is the ipId? You should also tell me if you want to add a minting fee, or if you want to enable commercial use of your IP. If so, you can add a revenue share as well.\",\n                    action: \"ATTACH_TERMS\",\n                },\n            },\n            {\n                user: \"{{user1}}\",\n                content: {\n                    text: \"Attach commercial, 10% rev share license terms to IP Asset 0x2265F2b8e47F98b3Bdf7a1937EAc27282954A4Db\",\n                },\n            },\n        ],\n    ],\n    similes: [\"ATTACH_TERMS\", \"ATTACH_TERMS_TO_IP\"],\n};\n","import {\n    composeContext,\n    elizaLogger,\n    generateObjectDeprecated,\n    HandlerCallback,\n    ModelClass,\n    IAgentRuntime,\n    Memory,\n    State,\n} from \"@elizaos/core\";\nimport { getAvailableLicensesTemplate, licenseIPTemplate } from \"../templates\";\nimport { Address } from \"viem\";\nimport { IPLicenseDetails, RESOURCE_TYPE } from \"../types/api\";\nimport { API_KEY, API_URL } from \"../lib/api\";\nimport { storyOdyssey } from \"viem/chains\";\n\nexport { licenseIPTemplate };\n\n// Types for request/response\ntype GetAvailableLicensesParams = {\n    ipid: Address;\n};\n\ntype GetAvailableLicensesResponse = {\n    data: IPLicenseDetails[];\n};\n\n/**\n * Class to handle fetching available licenses for an IP asset from Story Protocol\n */\nexport class GetAvailableLicensesAction {\n    // Default query options for license terms\n    private readonly defaultQueryOptions = {\n        pagination: { limit: 10, offset: 0 },\n        orderBy: \"blockNumber\",\n        orderDirection: \"desc\",\n    };\n\n    async getAvailableLicenses(\n        params: GetAvailableLicensesParams\n    ): Promise<GetAvailableLicensesResponse> {\n        elizaLogger.log(\n            \"Fetching from\",\n            `${API_URL}/${RESOURCE_TYPE.IP_LICENSE_DETAILS}`\n        );\n\n        const response = await fetch(\n            `${API_URL}/${RESOURCE_TYPE.IP_LICENSE_DETAILS}`,\n            {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\",\n                    \"x-api-key\": API_KEY,\n                    \"x-chain\": storyOdyssey.id.toString(),\n                },\n                cache: \"no-cache\",\n                body: JSON.stringify({\n                    ip_ids: [params.ipid],\n                    options: this.defaultQueryOptions,\n                }),\n            }\n        );\n\n        if (!response.ok) {\n            throw new Error(`HTTP error! status: ${response.status}`);\n        }\n\n        try {\n            const text = await response.text();\n            const licenseDetailsResponse = JSON.parse(text);\n            elizaLogger.log(\"licenseDetailsResponse\", licenseDetailsResponse);\n            return licenseDetailsResponse;\n        } catch (e) {\n            elizaLogger.error(\"Failed to parse response\");\n            throw new Error(`Failed to parse JSON response: ${e.message}`);\n        }\n    }\n}\n\n/**\n * Formats a license's terms into a human-readable string\n */\nconst formatLicenseTerms = (license: IPLicenseDetails): string => {\n    const terms = license.terms;\n    return `License ID: ${license.id}\n- Terms:\n  • Commercial Use: ${terms.commercialUse ? \"Allowed\" : \"Not Allowed\"}\n  • Commercial Attribution: ${terms.commercialAttribution ? \"Required\" : \"Not Required\"}\n  • Derivatives: ${terms.derivativesAllowed ? \"Allowed\" : \"Not Allowed\"}\n  • Derivatives Attribution: ${terms.derivativesAttribution ? \"Required\" : \"Not Required\"}\n  • Derivatives Approval: ${terms.derivativesApproval ? \"Required\" : \"Not Required\"}\n  • Revenue Share: ${terms.commercialRevenueShare ? terms.commercialRevenueShare + \"%\" : \"Not Required\"}\n`;\n};\n\n/**\n * Main action configuration for getting available licenses\n */\nexport const getAvailableLicensesAction = {\n    name: \"GET_AVAILABLE_LICENSES\",\n    description: \"Get available licenses for an IP Asset on Story\",\n    handler: async (\n        runtime: IAgentRuntime,\n        message: Memory,\n        state: State,\n        options: any,\n        callback?: HandlerCallback\n    ): Promise<boolean> => {\n        elizaLogger.log(\"Starting GET_AVAILABLE_LICENSES handler...\");\n\n        // Initialize or update state\n        state = !state\n            ? ((await runtime.composeState(message)) as State)\n            : await runtime.updateRecentMessageState(state);\n\n        // Generate parameters from context\n        const content = await generateObjectDeprecated({\n            runtime,\n            context: composeContext({\n                state,\n                template: getAvailableLicensesTemplate,\n            }),\n            modelClass: ModelClass.SMALL,\n        });\n\n        // Fetch and format license data\n        const action = new GetAvailableLicensesAction();\n        try {\n            const response = await action.getAvailableLicenses(content);\n            const formattedResponse = response.data\n                .map(formatLicenseTerms)\n                .join(\"\\n\");\n\n            callback?.({\n                text: formattedResponse,\n                action: \"GET_AVAILABLE_LICENSES\",\n                source: \"Story Protocol API\",\n            });\n            return true;\n        } catch (e) {\n            elizaLogger.error(\"Error fetching available licenses:\", e.message);\n            callback?.({\n                text: `Error fetching available licenses: ${e.message}`,\n            });\n            return false;\n        }\n    },\n    template: getAvailableLicensesTemplate,\n    validate: async () => true,\n    examples: [\n        [\n            {\n                user: \"{{user1}}\",\n                content: {\n                    text: \"Get available licenses for an IP Asset 0x2265F2b8e47F98b3Bdf7a1937EAc27282954A4Db\",\n                    action: \"GET_AVAILABLE_LICENSES\",\n                },\n            },\n        ],\n    ],\n    similes: [\n        \"AVAILABLE_LICENSES\",\n        \"AVAILABLE_LICENSES_FOR_IP\",\n        \"AVAILABLE_LICENSES_FOR_ASSET\",\n    ],\n};\n","import {\n    IPLicenseTerms,\n    PILTerms,\n    QUERY_ORDER_BY,\n    QUERY_ORDER_DIRECTION,\n    QueryOptions,\n    RESOURCE_TYPE,\n    ResourceType,\n    Trait,\n} from \"../types/api\";\nimport { elizaLogger } from \"@elizaos/core\";\n\nimport { camelize } from \"./utils\";\nconst API_BASE_URL = process.env.STORY_API_BASE_URL;\nconst API_VERSION = \"v2\";\nexport const API_URL = `${API_BASE_URL}/${API_VERSION}`;\nexport const API_KEY = process.env.STORY_API_KEY || \"\";\n\nexport async function getResource(\n    resourceName: ResourceType,\n    resourceId: string,\n    options?: QueryOptions\n) {\n    try {\n        elizaLogger.log(\n            `Fetching resource ${API_URL}/${resourceName}/${resourceId}`\n        );\n        const res = await fetch(`${API_URL}/${resourceName}/${resourceId}`, {\n            method: \"GET\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"x-api-key\": API_KEY as string,\n                \"x-chain\": \"1516\",\n            },\n        });\n        if (res.ok) {\n            elizaLogger.log(\"Response is ok\");\n            return res.json();\n        } else {\n            elizaLogger.log(\"Response is not ok\");\n            elizaLogger.log(JSON.stringify(res));\n            throw new Error(`HTTP error! status: ${res.status}`);\n        }\n    } catch (error) {\n        console.error(error);\n    }\n}\n\nexport async function listResource(\n    resourceName: ResourceType,\n    options?: QueryOptions\n) {\n    try {\n        const _options = {\n            pagination: {\n                limit: 10,\n                offset: 0,\n            },\n            orderBy: QUERY_ORDER_BY.BLOCK_NUMBER,\n            orderDirection: QUERY_ORDER_DIRECTION.DESC,\n            ...options,\n        };\n        elizaLogger.log(`Calling Story API ${resourceName}`);\n        elizaLogger.log(`STORY_API_KEY: ${API_KEY}`);\n        elizaLogger.log(`API_URL: ${API_URL}`);\n        elizaLogger.log(`API_VERSION: ${API_VERSION}`);\n        elizaLogger.log(`_options: ${JSON.stringify(_options)}`);\n        const res = await fetch(`${API_URL}/${resourceName}`, {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"x-api-key\": API_KEY as string,\n                \"x-chain\": \"1516\",\n            },\n            cache: \"no-cache\",\n            ...(_options && { body: JSON.stringify({ options: _options }) }),\n        });\n        if (res.ok) {\n            elizaLogger.log(\"Response is ok\");\n            elizaLogger.log(res.ok);\n            return res.json();\n        } else {\n            elizaLogger.log(\"Response is not ok\");\n            elizaLogger.log(res);\n            return res;\n        }\n    } catch (error) {\n        elizaLogger.log(\"List resource Error\");\n        console.error(error);\n    }\n}\n\nexport async function fetchLicenseTermsDetails(data: IPLicenseTerms[]) {\n    const requests = data.map((item) =>\n        getResource(RESOURCE_TYPE.LICENSE_TERMS, item.licenseTermsId)\n    );\n    const results = await Promise.all(requests);\n\n    return results\n        .filter((value) => !!value)\n        .map((result) => {\n            return {\n                ...result.data,\n                licenseTerms: convertLicenseTermObject(\n                    result.data.licenseTerms\n                ),\n            };\n        });\n}\n\ntype LicenseTerms = Partial<PILTerms>;\n\nexport function convertLicenseTermObject(licenseTerms: Trait[]): LicenseTerms {\n    return licenseTerms.reduce((acc, option: Trait): LicenseTerms => {\n        const key = camelize(option.trait_type) as keyof PILTerms;\n        acc[key] =\n            option.value === \"true\"\n                ? true\n                : option.value === \"false\"\n                  ? false\n                  : (option.value as any);\n        return acc as LicenseTerms;\n    }, {});\n}\n","import {\n    composeContext,\n    elizaLogger,\n    generateObjectDeprecated,\n    HandlerCallback,\n    ModelClass,\n    IAgentRuntime,\n    Memory,\n    State,\n} from \"@elizaos/core\";\nimport { getIPDetailsTemplate } from \"../templates\";\nimport { Address } from \"viem\";\nimport { Asset, RESOURCE_TYPE } from \"../types/api\";\nimport { API_URL, getResource } from \"../lib/api\";\n\nexport { getIPDetailsTemplate };\n\n// Types for the action parameters and response\ntype GetIPDetailsParams = {\n    ipId: Address;\n};\n\ntype GetIPDetailsResponse = {\n    data: Asset;\n};\n\n/**\n * Class handling IP details retrieval from Story Protocol\n */\nclass GetIPDetailsAction {\n    async getIPDetails(\n        params: GetIPDetailsParams\n    ): Promise<GetIPDetailsResponse> {\n        elizaLogger.log(\"Fetching from\", `${API_URL}/${RESOURCE_TYPE.ASSET}`);\n        return (await getResource(\n            RESOURCE_TYPE.ASSET,\n            params.ipId\n        )) as GetIPDetailsResponse;\n    }\n}\n\n/**\n * Formats IP asset details into a readable string\n */\nconst formatIPDetails = (data: Asset): string => `IP Asset Details:\nID: ${data.id}\nNFT Name: ${data.nftMetadata.name}\nToken Contract: ${data.nftMetadata.tokenContract}\nToken ID: ${data.nftMetadata.tokenId}\nImage URL: ${data.nftMetadata.imageUrl}\n\nRelationships:\n• Ancestors: ${data.ancestorCount}\n• Descendants: ${data.descendantCount}\n• Parents: ${data.parentCount || 0}\n• Children: ${data.childCount || 0}\n• Roots: ${data.rootCount || 0}\n\nCreated:\nBlock #${data.blockNumber}\nTimestamp: ${data.blockTimestamp}`;\n\n/**\n * Main action configuration for getting IP details\n */\nexport const getIPDetailsAction = {\n    name: \"GET_IP_DETAILS\",\n    description: \"Get details for an IP Asset on Story\",\n    handler: async (\n        runtime: IAgentRuntime,\n        message: Memory,\n        state: State,\n        options: any,\n        callback?: HandlerCallback\n    ): Promise<boolean> => {\n        elizaLogger.log(\"Starting GET_IP_DETAILS handler...\");\n\n        // Initialize or update state\n        state = !state\n            ? ((await runtime.composeState(message)) as State)\n            : await runtime.updateRecentMessageState(state);\n\n        // Generate content using template\n        const content = await generateObjectDeprecated({\n            runtime,\n            context: composeContext({ state, template: getIPDetailsTemplate }),\n            modelClass: ModelClass.SMALL,\n        });\n\n        // Fetch and format IP details\n        const action = new GetIPDetailsAction();\n        try {\n            const response = await action.getIPDetails(content);\n            const formattedResponse = formatIPDetails(response.data);\n\n            callback?.({\n                text: formattedResponse,\n                action: \"GET_IP_DETAILS\",\n                source: \"Story Protocol API\",\n            });\n            return true;\n        } catch (e) {\n            elizaLogger.error(\"Error fetching IP details:\", e.message);\n            callback?.({\n                text: `Error fetching IP details: ${e.message}`,\n            });\n            return false;\n        }\n    },\n    template: getIPDetailsTemplate,\n    validate: async () => true,\n    // Example usage of the action\n    examples: [\n        [\n            {\n                user: \"{{user1}}\",\n                content: {\n                    text: \"Get details for an IP Asset 0x2265F2b8e47F98b3Bdf7a1937EAc27282954A4Db\",\n                    action: \"GET_IP_DETAILS\",\n                },\n            },\n        ],\n    ],\n    similes: [\"IP_DETAILS\", \"IP_DETAILS_FOR_ASSET\", \"IP_DETAILS_FOR_IP\"],\n};\n","export * from \"./actions/registerIP\";\nexport * from \"./actions/licenseIP\";\nexport * from \"./actions/attachTerms\";\nexport * from \"./actions/getAvailableLicenses\";\nexport * from \"./actions/getIPDetails\";\nexport * from \"./providers/wallet\";\nexport * from \"./types\";\n\nimport { Plugin } from \"@elizaos/core\";\nimport { storyWalletProvider } from \"./providers/wallet\";\nimport { registerIPAction } from \"./actions/registerIP\";\nimport { licenseIPAction } from \"./actions/licenseIP\";\nimport { getAvailableLicensesAction } from \"./actions/getAvailableLicenses\";\nimport { getIPDetailsAction } from \"./actions/getIPDetails\";\nimport { attachTermsAction } from \"./actions/attachTerms\";\n\nexport const storyPlugin: Plugin = {\n    name: \"story\",\n    description: \"Story integration plugin\",\n    providers: [storyWalletProvider],\n    evaluators: [],\n    services: [],\n    actions: [\n        registerIPAction,\n        licenseIPAction,\n        attachTermsAction,\n        getAvailableLicensesAction,\n        getIPDetailsAction,\n    ],\n};\n\nexport default storyPlugin;\n"],"mappings":"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","names":["composeContext","elizaLogger","generateObjectDeprecated","ModelClass","elizaLogger","composeContext","generateObjectDeprecated","ModelClass","composeContext","elizaLogger","generateObjectDeprecated","ModelClass","elizaLogger","composeContext","generateObjectDeprecated","ModelClass","composeContext","elizaLogger","generateObjectDeprecated","ModelClass","elizaLogger","elizaLogger","storyOdyssey","elizaLogger","storyOdyssey","generateObjectDeprecated","composeContext","ModelClass","composeContext","elizaLogger","generateObjectDeprecated","ModelClass","elizaLogger","generateObjectDeprecated","composeContext","ModelClass"]}