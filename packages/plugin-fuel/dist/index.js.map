{"version":3,"sources":["../src/actions/transfer.ts","../src/providers/wallet.ts","../src/templates/index.ts","../src/index.ts"],"sourcesContent":["import {\n    Action,\n    composeContext,\n    generateObjectDeprecated,\n    IAgentRuntime,\n    ModelClass,\n    State,\n} from \"@elizaos/core\";\nimport { initWalletProvider, WalletProvider } from \"../providers/wallet\";\nimport { bn } from \"fuels\";\nimport { transferTemplate } from \"../templates\";\n\ntype TransferParams = {\n    toAddress: string;\n    amount: string;\n};\n\nexport class TransferAction {\n    constructor(private walletProvider: WalletProvider) {}\n\n    async transfer(params: TransferParams) {\n        try {\n            const { toAddress, amount } = params;\n            const res = await this.walletProvider.wallet.transfer(\n                toAddress,\n                bn.parseUnits(amount)\n            );\n            const tx = await res.waitForResult();\n            return tx;\n        } catch (error) {\n            throw new Error(`Transfer failed: ${error.message}`);\n        }\n    }\n}\n\nconst buildTransferDetails = async (state: State, runtime: IAgentRuntime) => {\n    const context = composeContext({\n        state,\n        template: transferTemplate,\n    });\n\n    const transferDetails = (await generateObjectDeprecated({\n        runtime,\n        context,\n        modelClass: ModelClass.SMALL,\n    })) as TransferParams;\n\n    return transferDetails;\n};\n\nexport const transferAction: Action = {\n    name: \"transfer\",\n    description: \"Transfer Fuel ETH between addresses on Fuel Ignition\",\n    handler: async (runtime, message, state, options, callback) => {\n        const walletProvider = await initWalletProvider(runtime);\n        const action = new TransferAction(walletProvider);\n\n        const paramOptions = await buildTransferDetails(state, runtime);\n\n        try {\n            const transferResp = await action.transfer(paramOptions);\n            if (callback) {\n                callback({\n                    text: `Successfully transferred ${paramOptions.amount} ETH to ${paramOptions.toAddress}\\nTransaction Hash: ${transferResp.id}`,\n                    content: {\n                        success: true,\n                        hash: transferResp.id,\n                        amount: paramOptions.amount,\n                        recipient: paramOptions.toAddress,\n                    },\n                });\n            }\n            return true;\n        } catch (error) {\n            console.error(\"Error during token transfer:\", error);\n            if (callback) {\n                callback({\n                    text: `Error transferring tokens: ${error.message}`,\n                    content: { error: error.message },\n                });\n            }\n            return false;\n        }\n    },\n    // template: transferTemplate,\n    validate: async (runtime: IAgentRuntime) => {\n        const privateKey = runtime.getSetting(\"FUEL_PRIVATE_KEY\");\n        return typeof privateKey === \"string\" && privateKey.startsWith(\"0x\");\n    },\n    examples: [\n        [\n            {\n                user: \"assistant\",\n                content: {\n                    text: \"I'll help you transfer 1 ETH to 0x8F8afB12402C9a4bD9678Bec363E51360142f8443FB171655eEd55dB298828D1\",\n                    action: \"SEND_TOKENS\",\n                },\n            },\n            {\n                user: \"user\",\n                content: {\n                    text: \"Transfer 1 ETH to 0x8F8afB12402C9a4bD9678Bec363E51360142f8443FB171655eEd55dB298828D1\",\n                    action: \"SEND_TOKENS\",\n                },\n            },\n        ],\n    ],\n    similes: [\"TRANSFER_FUEL_ETH\"],\n};\n","import type { IAgentRuntime, Provider, Memory, State } from \"@elizaos/core\";\nimport { Provider as FuelProvider, Wallet, WalletUnlocked } from \"fuels\";\n\nexport class WalletProvider {\n    wallet: WalletUnlocked;\n\n    constructor(privateKey: `0x${string}`, provider: FuelProvider) {\n        this.wallet = Wallet.fromPrivateKey(privateKey, provider);\n    }\n\n    getAddress(): string {\n        return this.wallet.address.toB256();\n    }\n\n    async getBalance() {\n        const balance = await this.wallet.getBalance();\n        return balance.format();\n    }\n}\n\nexport const initWalletProvider = async (runtime: IAgentRuntime) => {\n    const privateKey = runtime.getSetting(\"FUEL_PRIVATE_KEY\");\n    if (!privateKey) {\n        throw new Error(\"FUEL_PRIVATE_KEY is missing\");\n    }\n    const fuelProviderUrl =\n        runtime.getSetting(\"FUEL_PROVIDER_URL\") ||\n        \"https://mainnet.fuel.network/v1/graphql\";\n\n    const provider = await FuelProvider.create(fuelProviderUrl);\n    return new WalletProvider(privateKey as `0x${string}`, provider);\n};\n\nexport const fuelWalletProvider: Provider = {\n    async get(\n        runtime: IAgentRuntime,\n        _message: Memory,\n        _state?: State\n    ): Promise<string | null> {\n        const walletProvider = await initWalletProvider(runtime);\n        const balance = await walletProvider.getBalance();\n        return `Fuel Wallet Address: ${walletProvider.getAddress()}\\nBalance: ${balance} ETH`;\n    },\n};\n","export const transferTemplate = `Given the recent messages and wallet information below:\n\n{{recentMessages}}\n\n{{walletInfo}}\n\nExtract the following information about the requested transfer:\n- Amount to transfer: Must be a string representing the amount in ETH (only number without coin symbol, e.g., \"0.1\")\n- Recipient address: Must be a valid Fuel wallet address starting with \"0x\"\n\nRespond with a JSON markdown block containing only the extracted values. All fields except 'token' are required:\n\n\\`\\`\\`json\n{\n    \"amount\": string,\n    \"toAddress\": string,\n}\n\\`\\`\\`\n`;\n","import { Plugin } from \"@elizaos/core\";\nimport { transferAction } from \"./actions/transfer\";\nimport { fuelWalletProvider } from \"./providers/wallet\";\n\nexport const fuelPlugin: Plugin = {\n    name: \"fuel\",\n    description: \"Fuel blockchain integration plugin\",\n    providers: [fuelWalletProvider],\n    evaluators: [],\n    services: [],\n    actions: [transferAction],\n};\n\nexport default fuelPlugin;\n"],"mappings":"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","names":[]}